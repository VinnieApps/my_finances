FROM ubuntu:latest

ENV DEBIAN_FRONTEND noninteractive

RUN apt-get update -y && \
    apt-get install -y mysql-client python3 python3-venv python3-setuptools

ENV PATH $CHROMEDRIVER_DIR:$PATH

COPY ./app /opt/app
COPY ./alembic /opt/alembic
COPY ./alembic.ini /opt/alembic.ini
COPY ./setup.py /opt/setup.py
COPY ./integration_tests /opt/integration_tests

WORKDIR /opt
RUN python3 setup.py install

CMD [ "/bin/bash", "-c", "integration_tests/run_application.sh" ]
